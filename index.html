<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Marriage Meeting Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.0/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { ChevronLeft, ChevronRight, Calendar, CheckSquare, Heart, Target, ShoppingCart, Plus, X, Check } = lucide;

        const MarriageMeetingTool = () => {
            const [currentWeek, setCurrentWeek] = useState(new Date());
            const [weekData, setWeekData] = useState(() => {
                const saved = localStorage.getItem('marriageMeetingData');
                return saved ? JSON.parse(saved) : {};
            });

            // Save to localStorage whenever data changes
            useEffect(() => {
                localStorage.setItem('marriageMeetingData', JSON.stringify(weekData));
            }, [weekData]);

            // Get Monday of current week
            const getMonday = (date) => {
                const d = new Date(date);
                const day = d.getDay();
                const diff = d.getDate() - day + (day === 0 ? -6 : 1);
                return new Date(d.setDate(diff));
            };

            const formatWeekKey = (date) => {
                const monday = getMonday(date);
                return monday.toISOString().split('T')[0];
            };

            const formatWeekDisplay = (date) => {
                const monday = getMonday(date);
                const sunday = new Date(monday);
                sunday.setDate(sunday.getDate() + 6);
                
                return `${monday.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - ${sunday.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;
            };

            // Initialize week data if it doesn't exist
            const initializeWeekData = () => {
                const weekKey = formatWeekKey(currentWeek);
                if (!weekData[weekKey]) {
                    const newWeekData = {
                        schedule: {
                            Monday: [''],
                            Tuesday: [''],
                            Wednesday: [''],
                            Thursday: [''],
                            Friday: [''],
                            Saturday: [''],
                            Sunday: ['']
                        },
                        todos: [],
                        prayers: [],
                        goals: [],
                        grocery: []
                    };
                    setWeekData(prev => ({ ...prev, [weekKey]: newWeekData }));
                    return newWeekData;
                }
                return weekData[formatWeekKey(currentWeek)];
            };

            const currentWeekData = initializeWeekData();

            // Update functions
            const updateSchedule = (day, index, value) => {
                const weekKey = formatWeekKey(currentWeek);
                setWeekData(prev => ({
                    ...prev,
                    [weekKey]: {
                        ...prev[weekKey],
                        schedule: {
                            ...prev[weekKey].schedule,
                            [day]: prev[weekKey].schedule[day].map((item, i) => i === index ? value : item)
                        }
                    }
                }));
            };

            const addScheduleLine = (day) => {
                const weekKey = formatWeekKey(currentWeek);
                setWeekData(prev => ({
                    ...prev,
                    [weekKey]: {
                        ...prev[weekKey],
                        schedule: {
                            ...prev[weekKey].schedule,
                            [day]: [...prev[weekKey].schedule[day], '']
                        }
                    }
                }));
            };

            const removeScheduleLine = (day, index) => {
                const weekKey = formatWeekKey(currentWeek);
                setWeekData(prev => ({
                    ...prev,
                    [weekKey]: {
                        ...prev[weekKey],
                        schedule: {
                            ...prev[weekKey].schedule,
                            [day]: prev[weekKey].schedule[day].filter((_, i) => i !== index)
                        }
                    }
                }));
            };

            const updateList = (listType, items) => {
                const weekKey = formatWeekKey(currentWeek);
                setWeekData(prev => ({
                    ...prev,
                    [weekKey]: {
                        ...prev[weekKey],
                        [listType]: items
                    }
                }));
            };

            const addListItem = (listType, text = '') => {
                const currentItems = currentWeekData[listType] || [];
                const newItem = { id: Date.now(), text, completed: false };
                updateList(listType, [...currentItems, newItem]);
            };

            const toggleListItem = (listType, id) => {
                const currentItems = currentWeekData[listType] || [];
                const updatedItems = currentItems.map(item => 
                    item.id === id ? { ...item, completed: !item.completed } : item
                );
                updateList(listType, updatedItems);
            };

            const updateListItem = (listType, id, text) => {
                const currentItems = currentWeekData[listType] || [];
                const updatedItems = currentItems.map(item => 
                    item.id === id ? { ...item, text } : item
                );
                updateList(listType, updatedItems);
            };

            const removeListItem = (listType, id) => {
                const currentItems = currentWeekData[listType] || [];
                const updatedItems = currentItems.filter(item => item.id !== id);
                updateList(listType, updatedItems);
            };

            const navigateWeek = (direction) => {
                const newDate = new Date(currentWeek);
                newDate.setDate(newDate.getDate() + (direction * 7));
                setCurrentWeek(newDate);
            };

            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

            const ListSection = ({ title, listType, icon: Icon, placeholder }) => {
                const items = currentWeekData[listType] || [];
                
                return React.createElement('div', { className: "bg-white rounded-lg border p-4" },
                    React.createElement('div', { className: "flex items-center gap-2 mb-3" },
                        React.createElement(Icon, { className: "w-5 h-5 text-blue-600" }),
                        React.createElement('h3', { className: "text-lg font-semibold text-gray-800" }, title),
                        React.createElement('button', {
                            onClick: () => addListItem(listType),
                            className: "ml-auto p-1 text-blue-600 hover:bg-blue-50 rounded"
                        }, React.createElement(Plus, { className: "w-4 h-4" }))
                    ),
                    React.createElement('div', { className: "space-y-2" },
                        items.map((item) =>
                            React.createElement('div', { key: item.id, className: "flex items-center gap-2 group" },
                                React.createElement('button', {
                                    onClick: () => toggleListItem(listType, item.id),
                                    className: `p-1 rounded ${item.completed ? 'text-green-600' : 'text-gray-400'} hover:bg-gray-50`
                                }, React.createElement(Check, { className: "w-4 h-4" })),
                                React.createElement('input', {
                                    type: "text",
                                    value: item.text,
                                    onChange: (e) => updateListItem(listType, item.id, e.target.value),
                                    placeholder: placeholder,
                                    className: `flex-1 p-2 border rounded ${item.completed ? 'line-through text-gray-500 bg-gray-50' : ''}`
                                }),
                                React.createElement('button', {
                                    onClick: () => removeListItem(listType, item.id),
                                    className: "opacity-0 group-hover:opacity-100 p-1 text-red-500 hover:bg-red-50 rounded"
                                }, React.createElement(X, { className: "w-4 h-4" }))
                            )
                        ),
                        items.length === 0 && React.createElement('p', { className: "text-gray-500 text-center py-4" }, "No items yet. Click + to add one!")
                    )
                );
            };

            return React.createElement('div', { className: "max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen" },
                // Header
                React.createElement('div', { className: "bg-white rounded-lg shadow-sm border p-6 mb-6" },
                    React.createElement('div', { className: "flex items-center justify-between" },
                        React.createElement('div', { className: "flex items-center gap-4" },
                            React.createElement(Calendar, { className: "w-8 h-8 text-blue-600" }),
                            React.createElement('div', null,
                                React.createElement('h1', { className: "text-2xl font-bold text-gray-800" }, "Weekly Marriage Meeting"),
                                React.createElement('p', { className: "text-gray-600" }, "Planning and connecting together")
                            )
                        ),
                        React.createElement('div', { className: "flex items-center gap-2" },
                            React.createElement('button', {
                                onClick: () => navigateWeek(-1),
                                className: "p-2 text-gray-600 hover:bg-gray-100 rounded-full"
                            }, React.createElement(ChevronLeft, { className: "w-5 h-5" })),
                            React.createElement('span', { className: "text-lg font-semibold text-gray-800 px-4" },
                                formatWeekDisplay(currentWeek)
                            ),
                            React.createElement('button', {
                                onClick: () => navigateWeek(1),
                                className: "p-2 text-gray-600 hover:bg-gray-100 rounded-full"
                            }, React.createElement(ChevronRight, { className: "w-5 h-5" }))
                        )
                    )
                ),

                // Schedule Section
                React.createElement('div', { className: "bg-white rounded-lg border p-6 mb-6" },
                    React.createElement('h2', { className: "text-xl font-semibold text-gray-800 mb-4" }, "Weekly Schedule"),
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" },
                        days.map((day) =>
                            React.createElement('div', { key: day, className: "border rounded-lg p-3" },
                                React.createElement('h3', { className: "font-semibold text-gray-700 mb-2" }, day),
                                React.createElement('div', { className: "space-y-1" },
                                    (currentWeekData.schedule?.[day] || ['']).map((item, index) =>
                                        React.createElement('div', { key: index, className: "flex items-center gap-1" },
                                            React.createElement('input', {
                                                type: "text",
                                                value: item,
                                                onChange: (e) => updateSchedule(day, index, e.target.value),
                                                placeholder: "Add commitment or note...",
                                                className: "flex-1 p-2 text-sm border rounded"
                                            }),
                                            (currentWeekData.schedule?.[day] || []).length > 1 &&
                                            React.createElement('button', {
                                                onClick: () => removeScheduleLine(day, index),
                                                className: "p-1 text-red-500 hover:bg-red-50 rounded"
                                            }, React.createElement(X, { className: "w-3 h-3" }))
                                        )
                                    ),
                                    React.createElement('button', {
                                        onClick: () => addScheduleLine(day),
                                        className: "w-full p-2 text-blue-600 hover:bg-blue-50 rounded border border-dashed border-blue-300 text-sm"
                                    }, React.createElement(Plus, { className: "w-3 h-3 inline mr-1" }), "Add line")
                                )
                            )
                        )
                    )
                ),

                // Lists Section
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-6" },
                    React.createElement(ListSection, {
                        title: "To-Do List",
                        listType: "todos",
                        icon: CheckSquare,
                        placeholder: "Enter a task..."
                    }),
                    React.createElement(ListSection, {
                        title: "Prayer List",
                        listType: "prayers",
                        icon: Heart,
                        placeholder: "Enter a prayer request..."
                    }),
                    React.createElement(ListSection, {
                        title: "Goals",
                        listType: "goals",
                        icon: Target,
                        placeholder: "Enter a goal..."
                    }),
                    React.createElement(ListSection, {
                        title: "Grocery List",
                        listType: "grocery",
                        icon: ShoppingCart,
                        placeholder: "Enter grocery item..."
                    })
                )
            );
        };

        ReactDOM.render(React.createElement(MarriageMeetingTool), document.getElementById('root'));
    </script>
</body>
</html>
